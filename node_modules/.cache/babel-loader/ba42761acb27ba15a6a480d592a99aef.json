{"ast":null,"code":"import _classCallCheck from\"C:/Users/vened/Desktop/Weather/my_weather/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/vened/Desktop/Weather/my_weather/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/vened/Desktop/Weather/my_weather/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/vened/Desktop/Weather/my_weather/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import Form from'../Form/Form';import CalDate from'../Functions/CalDate';import CalTime from'../Functions/CalTime';import AirConditionItem from'./AirConditionItem';import'./AirCondition.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var API_key=\"157d33f8987d245bc6a1997408e90015\";var AirCondition=/*#__PURE__*/function(_React$Component){_inherits(AirCondition,_React$Component);var _super=_createSuper(AirCondition);function AirCondition(props){var _this;_classCallCheck(this,AirCondition);_this=_super.call(this,props);_this.getAir=function(e){e.preventDefault();fetch(\"http://api.openweathermap.org/data/2.5/weather?q=\".concat(_this.state.value,\"&APPID=\").concat(API_key)).then(function(response){if(response.ok){return response;}throw Error(\"Błąd pobierania danych z API\");}).then(function(response){return response.json();}).then(function(response){console.log(response);_this.getAirQuality(response.coord.lat,response.coord.lon);_this.setState(function(state){return{city:state.value,country:response.sys.country,date:CalDate(response.dt,response.timezone),time:CalTime(response.dt,response.timezone),error:false};});}).catch(function(err){console.log(err);_this.setState(function(prevState){return{error:true,city:prevState.city};});});};_this.inputHandler=function(e){_this.setState({value:e.target.value});};_this.submitHandler=function(e){_this.getAir(e);};_this.state={value:\"\",city:\"Miasto\",country:\"\",aqi:undefined,co:undefined,nh3:undefined,no:undefined,no2:undefined,o3:undefined,pm2_5:undefined,pm10:undefined,so2:undefined,error:false};return _this;}_createClass(AirCondition,[{key:\"getAirQuality\",value:function getAirQuality(lat,lon){var _this2=this;var result=null;result=fetch(\"http://api.openweathermap.org/data/2.5/air_pollution?lat=\".concat(lat,\"&lon=\").concat(lon,\"&appid=\").concat(API_key)).then(function(responseAirQuality){if(responseAirQuality.ok){return responseAirQuality;}throw Error(\"Błąd pobierania danych z API\");}).then(function(responseAirQuality){return responseAirQuality.json();}).then(function(responseAirQuality){console.log(responseAirQuality);_this2.setState(function(state){return{co:responseAirQuality.list[0].components.co,nh3:responseAirQuality.list[0].components.nh3,no:responseAirQuality.list[0].components.no,no2:responseAirQuality.list[0].components.no2,o3:responseAirQuality.list[0].components.o3,pm2_5:responseAirQuality.list[0].components.pm2_5,pm10:responseAirQuality.list[0].components.pm10,so2:responseAirQuality.list[0].components.so2,color:responseAirQuality.list[0].main.aqi,error:false};});return fetch(\"http://api.openweathermap.org/data/2.5/air_pollution?lat=\".concat(lat,\"&lon=\").concat(lon,\"&appid=\").concat(API_key));}).then(function(responseAirQuality){return responseAirQuality.json();}).catch(function(err){console.log(err);_this2.setState(function(prevState){return{error:true,city:prevState.city};});});result.then(function(r){fetch(\"https://weather-mysql-deploy.herokuapp.com/api/air\").then(function(responseAir){if(responseAir.ok){return responseAir;}throw Error(\"Błąd pobierania danych z API\");}).then(function(responseAir){return responseAir.json();}).then(function(responseAir){console.log(responseAir);console.log(r);_this2.setState(function(state){return{aqi:responseAir[r.list[0].main.aqi-1].condition,error:false};});});});}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"main\",style:{backgroundImage:\"url(\\\"/images/bg_air.jpg\\\")\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"city-form\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Wyszukaj miasto dla kt\\xF3rego chcesz sprawdzi\\u0107 obecny stan powietrza\"}),/*#__PURE__*/_jsx(Form,{value:this.state.value,handler:this.inputHandler,submit:this.submitHandler})]}),/*#__PURE__*/_jsx(\"div\",{children:this.state.city?/*#__PURE__*/_jsx(AirConditionItem,{air:this.state}):null})]});}}]);return AirCondition;}(React.Component);;export default AirCondition;","map":{"version":3,"sources":["C:/Users/vened/Desktop/Weather/my_weather/client/src/components/AirCondition/AirCondition.js"],"names":["React","Form","CalDate","CalTime","AirConditionItem","API_key","AirCondition","props","getAir","e","preventDefault","fetch","state","value","then","response","ok","Error","json","console","log","getAirQuality","coord","lat","lon","setState","city","country","sys","date","dt","timezone","time","error","catch","err","prevState","inputHandler","target","submitHandler","aqi","undefined","co","nh3","no","no2","o3","pm2_5","pm10","so2","result","responseAirQuality","list","components","color","main","r","responseAir","condition","backgroundImage","Component"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport Form from '../Form/Form'\r\nimport CalDate from '../Functions/CalDate';\r\nimport CalTime from '../Functions/CalTime';\r\nimport AirConditionItem from './AirConditionItem';\r\nimport './AirCondition.css';\r\n\r\nconst API_key=\"157d33f8987d245bc6a1997408e90015\";\r\n\r\nclass AirCondition extends React.Component\r\n{\r\n    constructor(props)\r\n    {\r\n        super(props)\r\n        this.state=\r\n        {\r\n        value:\"\",\r\n        city:\"Miasto\",\r\n        country:\"\",\r\n        aqi:undefined,\r\n        co:undefined,\r\n        nh3:undefined,\r\n        no:undefined,\r\n        no2:undefined,\r\n        o3:undefined,\r\n        pm2_5:undefined,\r\n        pm10:undefined,\r\n        so2:undefined,\r\n        error:false\r\n        };\r\n    };\r\n    \r\n    getAir = (e) =>\r\n    {\r\n        e.preventDefault()\r\n          \r\n        fetch(`http://api.openweathermap.org/data/2.5/weather?q=${this.state.value}&APPID=${API_key}`)\r\n        .then(response => \r\n        {\r\n            if(response.ok)\r\n            {\r\n                return response;\r\n            }\r\n            throw Error(\"Błąd pobierania danych z API\");\r\n        })\r\n        .then(response => response.json())\r\n        .then(response => \r\n        {\r\n            console.log(response);\r\n            this.getAirQuality(response.coord.lat,response.coord.lon);\r\n            this.setState(state =>(\r\n            {\r\n                city:state.value,\r\n                country:response.sys.country,\r\n                date:CalDate(response.dt,response.timezone),\r\n                time:CalTime(response.dt,response.timezone), \r\n                error:false\r\n            }));\r\n\r\n        })\r\n        .catch(err =>\r\n        {\r\n            console.log(err);\r\n\r\n            this.setState(prevState =>\r\n            {\r\n                return{\r\n                error:true,\r\n                city:prevState.city\r\n                }\r\n            });\r\n        });\r\n    };\r\n    getAirQuality(lat,lon)\r\n    {\r\n        var result = null;\r\n        result = fetch(`http://api.openweathermap.org/data/2.5/air_pollution?lat=${lat}&lon=${lon}&appid=${API_key}`)\r\n        .then(responseAirQuality => \r\n        {\r\n            if(responseAirQuality.ok)\r\n            {\r\n                return responseAirQuality;\r\n            }\r\n            throw Error(\"Błąd pobierania danych z API\");\r\n        })\r\n        .then(responseAirQuality => responseAirQuality.json())\r\n        .then(responseAirQuality => \r\n        {\r\n              \r\n            console.log(responseAirQuality);\r\n            this.setState(state =>(\r\n            {\r\n                co:responseAirQuality.list[0].components.co,\r\n                nh3:responseAirQuality.list[0].components.nh3,\r\n                no:responseAirQuality.list[0].components.no,\r\n                no2:responseAirQuality.list[0].components.no2,\r\n                o3:responseAirQuality.list[0].components.o3,\r\n                pm2_5:responseAirQuality.list[0].components.pm2_5,\r\n                pm10:responseAirQuality.list[0].components.pm10,\r\n                so2:responseAirQuality.list[0].components.so2,\r\n                color:responseAirQuality.list[0].main.aqi,\r\n                error:false\r\n            }))\r\n              return fetch(`http://api.openweathermap.org/data/2.5/air_pollution?lat=${lat}&lon=${lon}&appid=${API_key}`);\r\n        })\r\n        .then(responseAirQuality => responseAirQuality.json())         \r\n        .catch(err =>\r\n        {\r\n            console.log(err);\r\n            this.setState(prevState =>\r\n            {\r\n                return{\r\n                    error:true,\r\n                    city:prevState.city\r\n                }\r\n            });\r\n        });\r\n        \r\n        result.then(r =>\r\n        {\r\n            fetch(`https://weather-mysql-deploy.herokuapp.com/api/air`)\r\n            .then(responseAir => \r\n            {\r\n                if(responseAir.ok)\r\n                {\r\n                    return responseAir;\r\n                \r\n                }\r\n                    throw Error(\"Błąd pobierania danych z API\");\r\n            })\r\n            .then(responseAir => responseAir.json())\r\n            .then(responseAir => \r\n            {\r\n                console.log(responseAir);\r\n\r\n                console.log(r);\r\n            \r\n                this.setState(state =>(\r\n                {\r\n                    aqi:responseAir[r.list[0].main.aqi-1].condition,\r\n                    error:false\r\n                }));\r\n            });\r\n        });\r\n    };\r\n\r\n    inputHandler=(e)=>\r\n    {\r\n        this.setState(\r\n        {\r\n            value:e.target.value\r\n        });\r\n    };\r\n\r\n    submitHandler=(e)=>\r\n    {\r\n        this.getAir(e);\r\n    };\r\n    render(){\r\n        return(\r\n            <div className=\"main\"   style={\r\n                                    { \r\n                                        backgroundImage: `url(\"/images/bg_air.jpg\")` \r\n                                    }\r\n            }>\r\n                <div className=\"city-form\">\r\n                    <h1>Wyszukaj miasto dla którego chcesz sprawdzić obecny stan powietrza</h1>\r\n                    <Form \r\n                        value={this.state.value}  \r\n                        handler={this.inputHandler}\r\n                        submit={this.submitHandler}\r\n                    /> \r\n                </div> \r\n                <div>\r\n                    {this.state.city ?(\r\n                        <AirConditionItem air={this.state}/>   \r\n                    ):null}\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n};\r\nexport default AirCondition;"]},"metadata":{},"sourceType":"module"}